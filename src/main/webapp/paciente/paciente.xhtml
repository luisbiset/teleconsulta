<ui:composition template="/template/layout.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="jakarta.faces.facelets"
    xmlns:h="jakarta.faces.html"
    xmlns:f="jakarta.faces.core"
    xmlns:p="http://primefaces.org/ui">

    <ui:define name="conteudo">

        <h:form id="formPaciente">

            <p:growl id="msgs" showDetail="true"/>

            <h2>Gerenciamento de Pacientes</h2>

            <!-- BOTÃO NOVO -->
            <p:commandButton value="Novo Paciente"
                             icon="pi pi-plus"
                             action="#{pacienteController.novo}"
                             update=":formPaciente:dlg"
                             oncomplete="PF('dlgPaciente').show()" />

            <br/><br/>

            <!-- TABELA -->
            <p:dataTable value="#{pacienteController.pacientes}"
                         var="p"
                         paginator="true"
                         rows="10"
                          paginatorPosition="bottom"
                         >

                <p:column headerText="Nome">
                    <h:outputText value="#{p.nome}"/>
                </p:column>

                <p:column headerText="CPF">
                    <h:outputText value="#{p.cpf}"/>
                </p:column>

                <p:column headerText="Telefone">
                    <h:outputText value="#{p.telefone}"/>
                </p:column>

                <p:column headerText="Ações" style="width:150px; text-align:center;">

                    <p:commandButton icon="pi pi-pencil"
                                     process="@this"
                                     update=":formPaciente:dlg"
                                     action="#{pacienteController.editar(p)}"
                                     oncomplete="PF('dlgPaciente').show()" />

                    <!-- EXCLUIR -->
                    <p:commandButton icon="pi pi-trash"
                                     process="@this"
                                     update="@form"
                                     action="#{pacienteController.excluir(p.id)}"
                                     onclick="return confirm('Deseja excluir este paciente?');"/>
                </p:column>

            </p:dataTable>

            <!-- DIALOG -->
            <p:dialog id="dlg"
                      widgetVar="dlgPaciente"
                      header="Cadastro de Paciente"
                      modal="true"
                      closable="true"
                      resizable="false">

                <h:panelGrid columns="2" cellpadding="5">

                    <h:outputLabel value="Nome:"/>
                    <p:inputText value="#{pacienteController.paciente.nome}" required="true"/>

                    <h:outputLabel value="CPF:"/>
                    <p:inputText value="#{pacienteController.paciente.cpf}" required="true"/>

                    <h:outputLabel value="Telefone:"/>
                    <p:inputText value="#{pacienteController.paciente.telefone}" required="true"/>

                    <h:outputLabel value="Data de Nascimento:"/>
                    <p:datePicker value="#{pacienteController.paciente.dataNascimento}"
                                  pattern="dd/MM/yyyy"
                                  required="true"/>
                </h:panelGrid>

                <br/>

                <!-- SALVAR -->
                <p:commandButton value="Salvar"
                                 action="#{pacienteController.salvar}"
                                 update="@form"
                                 oncomplete="PF('dlgPaciente').hide();" />

            </p:dialog>

        </h:form>

    </ui:define>

</ui:composition>
